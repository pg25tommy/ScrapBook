/* src/app/globals.css */
/* Design Philosophy: Analog warmth + modern UI clarity */
/* See DESIGN_SPEC.md for complete visual language */

/* ---------------- Base / Reset ---------------- */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html, body {
  height: 100%;
}

body {
  margin: 0;

  /* Warm parchment base - deep earth tone */
  background-color: #f5f1e8;

  /* Layer 1: paper texture with visible fibers
     Layer 2: gentle vignette to anchor focus in middle
     Layer 3: subtle illuminated center (like real light table) */
  background-image:
    url('/textures/paper.png'),
    radial-gradient(ellipse at center, transparent 0%, rgba(42,35,28,0.12) 100%),
    radial-gradient(ellipse at center, rgba(255,252,245,0.15) 0%, transparent 60%);

  background-repeat: repeat, no-repeat, no-repeat;
  background-size: auto, cover, cover;
  background-position: top left, center, center;
  background-attachment: fixed, fixed, fixed;

  /* Soft black, never pure black (per DESIGN_SPEC.md §8) */
  color: #2a2a2a;

  /* Modern humanist sans-serif (per DESIGN_SPEC.md §8) */
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Inter", "Source Sans Pro",
               system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial,
               "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  /* Slight letter-spacing for airier feel (per DESIGN_SPEC.md §8) */
  letter-spacing: 0.01em;

  /* Reduce accidental text selection while dragging */
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

/* Accessibility: visible, tidy focus with earth tone */
:focus { outline: none; }
:focus-visible {
  outline: 2px solid #8b7355;  /* Warm brown instead of blue */
  outline-offset: 2px;
}

/* ---------------- Utilities ---------------- */

/* Warm parchment color utilities */
.paper-bg { background: #f5f1e8 !important; }
.top-band { background: #f5f1e8 !important; }

/* Hide scrollbars where we want clean edges */
.no-scrollbars::-webkit-scrollbar { display: none; }
.no-scrollbars { -ms-overflow-style: none; scrollbar-width: none; }

/* Promote an element to GPU layer */
.gpu-layer { transform: translateZ(0); will-change: transform; }

/* ---------------- UI Elements ---------------- */

/* Toolbar & buttons - Minimal but warm (per DESIGN_SPEC.md §10) */
.toolbar-btn {
  appearance: none;
  border: 1px solid rgba(208, 192, 160, 0.3);  /* Soft beige border */

  /* Soft rounded corners, not pill-shaped (per DESIGN_SPEC.md §10) */
  border-radius: 6px;

  /* Warm cream with slight paper grain overlay (per DESIGN_SPEC.md §10) */
  background:
    linear-gradient(to bottom, rgba(245, 241, 232, 0.02), transparent),
    rgba(255, 253, 248, 0.95);
  backdrop-filter: saturate(110%) blur(3px);

  /* Soft shadow with warm tint */
  box-shadow:
    0 1px 3px rgba(107, 93, 79, 0.08),
    0 1px 2px rgba(107, 93, 79, 0.06);

  /* Soft black text (per DESIGN_SPEC.md §8) */
  color: #2a2a2a;

  font-size: 12px;
  font-weight: 500;
  line-height: 1;
  padding: 8px 12px;
  cursor: pointer;

  /* 150-250ms range, ease-out (per DESIGN_SPEC.md §9) */
  transition:
    box-shadow 180ms ease-out,
    transform 150ms ease-out,
    background 200ms ease-out,
    border-color 180ms ease-out;
}

/* Earth-tone hover state (per DESIGN_SPEC.md §4.2) */
.toolbar-btn:hover {
  background:
    linear-gradient(to bottom, rgba(245, 241, 232, 0.04), transparent),
    rgba(255, 250, 240, 0.98);

  /* Slight warm highlight (per DESIGN_SPEC.md §4.2) */
  border-color: rgba(208, 192, 160, 0.5);

  /* Soft shadow lift (per DESIGN_SPEC.md §4.2) */
  box-shadow:
    0 2px 6px rgba(107, 93, 79, 0.12),
    0 3px 8px rgba(107, 93, 79, 0.08);
}

/* Light elastic feel on press (per DESIGN_SPEC.md §9) */
.toolbar-btn:active {
  transform: translateY(1px) scale(0.98);
  transition: transform 120ms ease-out;
}

/* Small shadow utility with warm tint */
.shadow {
  box-shadow: 0 2px 10px rgba(107, 93, 79, 0.10);
}

/* ---------------- Pixi Canvas Hygiene ---------------- */

/* Ensure Pixi's canvas doesn't overwrite background */
canvas {
  display: block;
  margin: 0;
  padding: 0;
  background: transparent; /* let paper texture show through */
}

canvas:focus { outline: none; }

/* ---------------- Mobile & Touch Optimizations ---------------- */

/* Prevent touch callouts and selection on iOS */
* {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  -webkit-touch-callout: none;
}

/* Allow text selection in editable areas */
input, textarea {
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

/* Smooth scrolling on iOS */
html {
  -webkit-overflow-scrolling: touch;
}

/* Prevent pull-to-refresh and overscroll on mobile */
body {
  overscroll-behavior: none;
}

/* Touch-friendly button sizing (min 44x44px per Apple HIG) */
.toolbar-btn {
  min-height: 44px;
  min-width: 44px;
}

/* Responsive breakpoints */
@media (max-width: 768px) {
  .toolbar-btn {
    font-size: 11px;
    padding: 6px 10px;
  }
}

@media (max-width: 480px) {
  .toolbar-btn {
    font-size: 10px;
    padding: 6px 8px;
  }
}

/* Hamburger Menu - Mobile/Desktop Behavior */
@media (max-width: 768px) {
  /* Show hamburger button on mobile */
  .hamburger-menu-btn {
    display: flex !important;
  }

  /* Show overlay when menu is open */
  .mobile-menu-overlay {
    display: block !important;
  }

  /* Toolbar as slide-out drawer on mobile */
  .toolbar-container {
    top: 0 !important;
    left: auto !important;
    right: 0 !important;
    transform: translateX(100%) !important; /* Hidden off-screen by default */
    max-width: min(320px, 80vw) !important;
    height: 100vh;
    flex-direction: column !important;
    justify-content: flex-start !important;
    padding: 80px 16px 16px 16px;
    background: rgba(255, 253, 248, 0.98);
    border-left: 1px solid rgba(208, 192, 160, 0.5);
    box-shadow: -4px 0 16px rgba(0, 0, 0, 0.15);
    overflow-y: auto;
    gap: 8px !important;
  }

  /* Slide in when menu is open */
  .toolbar-container.mobile-menu-open {
    transform: translateX(0) !important;
  }

  /* Make toolbar buttons full width on mobile */
  .toolbar-container .toolbar-btn {
    width: 100%;
    justify-content: flex-start;
    text-align: left;
  }

  /* Stack archive dropdown, slot counter vertically */
  .toolbar-container .archive-dropdown-container,
  .toolbar-container > span {
    width: 100%;
  }
}

/* Desktop - hide hamburger, show toolbar normally */
@media (min-width: 769px) {
  .hamburger-menu-btn {
    display: none !important;
  }

  .mobile-menu-overlay {
    display: none !important;
  }
}
